Notes:

Hat matrisen

$
H=W^{1/2}X(X^TWX)^{âˆ’1}X^TW^{1/2}
$

where:
H is the hat matrix.
X is the matrix of feature vectors.
W is the diagonal matrix of weights, and W^{1/2} is its square root, i.e., a matrix with the square roots of the weights on the diagonal.
